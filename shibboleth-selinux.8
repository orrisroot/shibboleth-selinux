.TH shibboleth-selinux 8
.SH NAME
shibboleth-selinux - SELinux policy for the Shibboleth daemon
.SH DESCRIPTION
SELinux is a kernel-level security module that enhances access control on Linux systems. The `shibboleth_selinux` policy defines Type Enforcement rules to ensure the Shibboleth service (`shibd`) operates securely.

This policy grants minimum necessary permissions to the `shibd` process and its associated files, including configuration files, PID files, caches, and log files.

.SH FILE CONTEXTS
SELinux applies specific contexts to the following file paths. These contexts define the files accessible by the `shibd` process and enforce mandatory access control.

.IP "/usr/sbin/shibd"
.br
  Type: `shibboleth_exec_t`
.br
  Description: The executable file for the Shibboleth daemon.
.IP "/etc/shibboleth(/.*)?"
.br
  Type: `shibboleth_config_t`
.br
  Description: The configuration files and directories for the Shibboleth service.
.IP "/run/shibboleth(/.*)?"
.br
  Type: `shibboleth_run_t`
.br
  Description: Runtime files, such as PID files and sockets.
.IP "/var/cache/shibboleth(/.*)?"
.br
  Type: `shibboleth_cache_t`
.br
  Description: The directory where Shibboleth stores cache data.
.IP "/var/log/shibboleth(/.*)?"
.br
  Type: `shibboleth_log_t`
.br
  Description: Shibboleth's log files.
.IP "/usr/lib/systemd/system/shibd.service"
.br
  Type: `shibboleth_unit_file_t`
.br
  Description: The systemd unit file for the Shibboleth service.
.SH TYPES
The main types defined by this policy are as follows:

.IP "`shibboleth_t`"
.br
  Description: The domain for the Shibboleth daemon (`shibd`). This process operates according to the rules of this domain.
.IP "`shibboleth_exec_t`"
.br
  Description: The type assigned to the `shibd` executable file.
.IP "`shibboleth_config_t`"
.br
  Description: The type assigned to configuration files. The `shibd` daemon can **read** these files.
.IP "`shibboleth_run_t`"
.br
  Description: The type assigned to runtime files (e.g., PID files). The `shibd` daemon has **read/write** access to this type.
.IP "`shibboleth_cache_t`"
.br
  Description: The type assigned to cache files. The `shibd` daemon has **read/write** access to this type.
.IP "`shibboleth_log_t`"
.br
  Description: The type assigned to log files. The `shibd` daemon can **append** to this type.
.IP "`shibboleth_unit_file_t`"
.br
  Description: The type assigned to the systemd unit file. This type allows `systemd` to manage the service, including the process of relabeling.

.SH EXAMPLE
An SELinux denial (AVC) message might be logged in `audit.log` when `shibd` attempts to write to a log file.

type=AVC msg=audit(1675209600.000:123): avc:  denied  { append } for  pid=... comm="shibd" name="shibboleth.log" dev=... ino=... scontext=system_u:system_r:shibboleth_t:s0 tcontext=system_u:object_r:shibboleth_log_t:s0 tclass=file
This denial message indicates that the `shibboleth_t` domain requires permission to `append` to a file of type `shibboleth_log_t`. This permission is granted by the `logging_manage_log_files(shibboleth_t, shibboleth_log_t)` macro.
.SH AUTHOR
This man page was generated by a large language model.
.SH SEE ALSO
`selinux(8)`, `semanage(8)`, `systemd(1)`
